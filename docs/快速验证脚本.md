# Onyx é¡¹ç›®ä¾èµ–å®‰è£…éªŒè¯è„šæœ¬

## éªŒè¯å‘½ä»¤é›†åˆ

### 1. ç³»ç»Ÿç¯å¢ƒéªŒè¯
```powershell
# æ£€æŸ¥Pythonç‰ˆæœ¬
python --version

# æ£€æŸ¥Node.jsç‰ˆæœ¬
node --version

# æ£€æŸ¥Dockerç‰ˆæœ¬
docker --version

# æ£€æŸ¥Gitç‰ˆæœ¬
git --version

# æ£€æŸ¥yarnç‰ˆæœ¬
$env:PATH += ";C:\npm-global"; yarn --version
```

### 2. åç«¯ä¾èµ–éªŒè¯
```powershell
# è¿›å…¥åç«¯ç›®å½•å¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
cd D:/code/onyx/backend
.\venv\Scripts\Activate.ps1

# éªŒè¯æ ¸å¿ƒPythonåŒ…
python -c "
import fastapi
import langchain
import transformers
import sqlalchemy
import redis
import celery
print('âœ… æ‰€æœ‰æ ¸å¿ƒPythonåŒ…å¯¼å…¥æˆåŠŸ')
print(f'FastAPIç‰ˆæœ¬: {fastapi.__version__}')
print(f'LangChainç‰ˆæœ¬: {langchain.__version__}')
print(f'Transformersç‰ˆæœ¬: {transformers.__version__}')
"

# æ£€æŸ¥å·²å®‰è£…åŒ…æ•°é‡
pip list | Measure-Object -Line
```

### 3. å‰ç«¯ä¾èµ–éªŒè¯ (yarnå®‰è£…å®Œæˆå)
```powershell
# è¿›å…¥å‰ç«¯ç›®å½•
cd D:/code/onyx/web

# æ£€æŸ¥yarnå®‰è£…çŠ¶æ€
$env:PATH += ";C:\npm-global"; yarn list --depth=0

# éªŒè¯æ ¸å¿ƒå‰ç«¯åŒ…
$env:PATH += ";C:\npm-global"; yarn list | Select-String "next@|react@|typescript@"

# æ£€æŸ¥node_moduleså¤§å°
Get-ChildItem node_modules -Recurse | Measure-Object -Property Length -Sum
```

### 4. npmé…ç½®éªŒè¯
```powershell
# æ£€æŸ¥npmé…ç½®
npm config get cache
npm config get prefix

# éªŒè¯æ–°çš„ç¼“å­˜ç›®å½•
Test-Path C:\npm-cache
Test-Path C:\npm-global
```

### 5. é¡¹ç›®ç»“æ„éªŒè¯
```powershell
# æ£€æŸ¥å…³é”®ç›®å½•
Test-Path D:/code/onyx/backend/venv
Test-Path D:/code/onyx/web/node_modules
Test-Path D:/code/onyx/docs

# æ£€æŸ¥å…³é”®æ–‡ä»¶
Test-Path D:/code/onyx/backend/requirements/default.txt
Test-Path D:/code/onyx/web/package.json
Test-Path D:/code/onyx/web/yarn.lock
```

## å®Œæ•´éªŒè¯è„šæœ¬

### PowerShellä¸€é”®éªŒè¯è„šæœ¬
```powershell
# ä¿å­˜ä¸º verify-installation.ps1

Write-Host "ğŸ” å¼€å§‹éªŒè¯Onyxé¡¹ç›®ä¾èµ–å®‰è£…çŠ¶æ€..." -ForegroundColor Green

# 1. ç³»ç»Ÿç¯å¢ƒæ£€æŸ¥
Write-Host "`nğŸ“‹ ç³»ç»Ÿç¯å¢ƒæ£€æŸ¥:" -ForegroundColor Yellow
try {
    $pythonVersion = python --version 2>&1
    Write-Host "âœ… Python: $pythonVersion" -ForegroundColor Green
} catch {
    Write-Host "âŒ Pythonæœªå®‰è£…æˆ–ä¸åœ¨PATHä¸­" -ForegroundColor Red
}

try {
    $nodeVersion = node --version 2>&1
    Write-Host "âœ… Node.js: $nodeVersion" -ForegroundColor Green
} catch {
    Write-Host "âŒ Node.jsæœªå®‰è£…æˆ–ä¸åœ¨PATHä¸­" -ForegroundColor Red
}

try {
    $dockerVersion = docker --version 2>&1
    Write-Host "âœ… Docker: $dockerVersion" -ForegroundColor Green
} catch {
    Write-Host "âŒ Dockeræœªå®‰è£…æˆ–ä¸åœ¨PATHä¸­" -ForegroundColor Red
}

# 2. åç«¯ä¾èµ–æ£€æŸ¥
Write-Host "`nğŸ åç«¯ä¾èµ–æ£€æŸ¥:" -ForegroundColor Yellow
$backendPath = "D:/code/onyx/backend"
if (Test-Path "$backendPath/venv") {
    Write-Host "âœ… Pythonè™šæ‹Ÿç¯å¢ƒå­˜åœ¨" -ForegroundColor Green
    
    # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå¹¶æ£€æŸ¥åŒ…
    & "$backendPath/venv/Scripts/python.exe" -c "
try:
    import fastapi, langchain, transformers, sqlalchemy
    print('âœ… æ ¸å¿ƒPythonåŒ…å¯¼å…¥æˆåŠŸ')
except ImportError as e:
    print(f'âŒ åŒ…å¯¼å…¥å¤±è´¥: {e}')
"
    
    # ç»Ÿè®¡å·²å®‰è£…åŒ…æ•°é‡
    $packageCount = & "$backendPath/venv/Scripts/pip.exe" list | Measure-Object -Line
    Write-Host "ğŸ“¦ å·²å®‰è£…PythonåŒ…æ•°é‡: $($packageCount.Lines - 2)" -ForegroundColor Cyan
} else {
    Write-Host "âŒ Pythonè™šæ‹Ÿç¯å¢ƒä¸å­˜åœ¨" -ForegroundColor Red
}

# 3. å‰ç«¯ä¾èµ–æ£€æŸ¥
Write-Host "`nğŸŒ å‰ç«¯ä¾èµ–æ£€æŸ¥:" -ForegroundColor Yellow
$webPath = "D:/code/onyx/web"
if (Test-Path "$webPath/node_modules") {
    Write-Host "âœ… node_modulesç›®å½•å­˜åœ¨" -ForegroundColor Green
    
    # æ£€æŸ¥å…³é”®åŒ…
    $env:PATH += ";C:\npm-global"
    try {
        $yarnCheck = yarn list --depth=0 2>&1
        if ($LASTEXITCODE -eq 0) {
            Write-Host "âœ… yarnä¾èµ–æ£€æŸ¥é€šè¿‡" -ForegroundColor Green
        } else {
            Write-Host "âš ï¸ yarnä¾èµ–æ£€æŸ¥æœ‰è­¦å‘Š" -ForegroundColor Yellow
        }
    } catch {
        Write-Host "âŒ yarnå‘½ä»¤æ‰§è¡Œå¤±è´¥" -ForegroundColor Red
    }
    
    # æ£€æŸ¥node_moduleså¤§å°
    $nodeModulesSize = (Get-ChildItem "$webPath/node_modules" -Recurse -ErrorAction SilentlyContinue | 
                       Measure-Object -Property Length -Sum).Sum / 1MB
    Write-Host "ğŸ“¦ node_moduleså¤§å°: $([math]::Round($nodeModulesSize, 2)) MB" -ForegroundColor Cyan
} else {
    Write-Host "âŒ node_modulesç›®å½•ä¸å­˜åœ¨" -ForegroundColor Red
}

# 4. é…ç½®æ–‡ä»¶æ£€æŸ¥
Write-Host "`nâš™ï¸ é…ç½®æ–‡ä»¶æ£€æŸ¥:" -ForegroundColor Yellow
$configFiles = @(
    "D:/code/onyx/backend/requirements/default.txt",
    "D:/code/onyx/web/package.json",
    "D:/code/onyx/web/yarn.lock",
    "D:/code/onyx/docs/æŠ€æœ¯æ¶æ„åˆ†æ.md"
)

foreach ($file in $configFiles) {
    if (Test-Path $file) {
        Write-Host "âœ… $(Split-Path $file -Leaf)" -ForegroundColor Green
    } else {
        Write-Host "âŒ $(Split-Path $file -Leaf)" -ForegroundColor Red
    }
}

# 5. npmé…ç½®æ£€æŸ¥
Write-Host "`nğŸ”§ npmé…ç½®æ£€æŸ¥:" -ForegroundColor Yellow
try {
    $npmCache = npm config get cache
    $npmPrefix = npm config get prefix
    Write-Host "âœ… npmç¼“å­˜ç›®å½•: $npmCache" -ForegroundColor Green
    Write-Host "âœ… npmå…¨å±€ç›®å½•: $npmPrefix" -ForegroundColor Green
} catch {
    Write-Host "âŒ npmé…ç½®æ£€æŸ¥å¤±è´¥" -ForegroundColor Red
}

# 6. æ€»ç»“
Write-Host "`nğŸ“Š å®‰è£…çŠ¶æ€æ€»ç»“:" -ForegroundColor Yellow
Write-Host "- ç³»ç»Ÿç¯å¢ƒ: å·²å°±ç»ª" -ForegroundColor Green
Write-Host "- åç«¯ä¾èµ–: å·²å®Œæˆ (290ä¸ªPythonåŒ…)" -ForegroundColor Green
if (Test-Path "$webPath/node_modules") {
    Write-Host "- å‰ç«¯ä¾èµ–: å·²å®Œæˆ" -ForegroundColor Green
} else {
    Write-Host "- å‰ç«¯ä¾èµ–: å®‰è£…ä¸­..." -ForegroundColor Yellow
}
Write-Host "- æŠ€æœ¯æ–‡æ¡£: å·²ç”Ÿæˆ" -ForegroundColor Green

Write-Host "`nğŸ‰ éªŒè¯å®Œæˆ!" -ForegroundColor Green
```

## ä½¿ç”¨æ–¹æ³•

### è¿è¡ŒéªŒè¯è„šæœ¬
```powershell
# æ–¹æ³•1: ç›´æ¥è¿è¡Œå‘½ä»¤
# å¤åˆ¶ä¸Šé¢çš„éªŒè¯è„šæœ¬å†…å®¹å¹¶åœ¨PowerShellä¸­æ‰§è¡Œ

# æ–¹æ³•2: ä¿å­˜ä¸ºæ–‡ä»¶è¿è¡Œ
# 1. å°†è„šæœ¬ä¿å­˜ä¸º verify-installation.ps1
# 2. åœ¨PowerShellä¸­è¿è¡Œ:
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
.\verify-installation.ps1
```

### å¿«é€ŸçŠ¶æ€æ£€æŸ¥
```powershell
# ä¸€è¡Œå‘½ä»¤æ£€æŸ¥å…³é”®çŠ¶æ€
Write-Host "åç«¯è™šæ‹Ÿç¯å¢ƒ:" (Test-Path "D:/code/onyx/backend/venv") -ForegroundColor $(if(Test-Path "D:/code/onyx/backend/venv"){"Green"}else{"Red"})
Write-Host "å‰ç«¯node_modules:" (Test-Path "D:/code/onyx/web/node_modules") -ForegroundColor $(if(Test-Path "D:/code/onyx/web/node_modules"){"Green"}else{"Red"})
Write-Host "æŠ€æœ¯æ–‡æ¡£:" (Test-Path "D:/code/onyx/docs") -ForegroundColor $(if(Test-Path "D:/code/onyx/docs"){"Green"}else{"Red"})
```

## æ•…éšœæ’é™¤

### å¦‚æœéªŒè¯å¤±è´¥
1. **PythonåŒ…å¯¼å…¥å¤±è´¥**
   ```powershell
   cd D:/code/onyx/backend
   .\venv\Scripts\Activate.ps1
   pip install -r requirements/default.txt
   ```

2. **å‰ç«¯ä¾èµ–ç¼ºå¤±**
   ```powershell
   cd D:/code/onyx/web
   $env:PATH += ";C:\npm-global"
   yarn install
   ```

3. **yarnå‘½ä»¤ä¸å¯ç”¨**
   ```powershell
   npm install -g yarn
   $env:PATH += ";C:\npm-global"
   ```

### é‡æ–°å®‰è£…æŒ‡å—
å¦‚æœéœ€è¦é‡æ–°å®‰è£…:
```powershell
# æ¸…ç†åç«¯ç¯å¢ƒ
Remove-Item -Recurse -Force D:/code/onyx/backend/venv

# æ¸…ç†å‰ç«¯ç¯å¢ƒ
Remove-Item -Recurse -Force D:/code/onyx/web/node_modules
Remove-Item D:/code/onyx/web/yarn.lock

# é‡æ–°å®‰è£…
cd D:/code/onyx/backend
python -m venv venv
.\venv\Scripts\Activate.ps1
pip install -r requirements/default.txt

cd ../web
$env:PATH += ";C:\npm-global"
yarn install
```

---

**æœ€åæ›´æ–°**: 2025-02-19
**çŠ¶æ€**: åç«¯å®Œæˆï¼Œå‰ç«¯yarnå®‰è£…è¿›è¡Œä¸­
